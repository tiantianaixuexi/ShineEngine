CompileFlags:
  # 优先使用 compile_commands.json（CMake 生成）
  CompilationDatabase: build-clang
  Add:
    # 让 clangd 按 MSVC(cl) 风格解析 compile_commands.json 里的参数
    - "--driver-mode=cl"
    # 至少启用 C++20/23（你的代码里用了 concepts / std::numbers）
    - "/std:c++latest"
    - "-fdeclspec"
    - "-D_WIN32"
    - "-D_WIN64"
    - "-DSHINE_OPENGL"
    - "-DSTB_IMAGE_IMPLEMENTATION"
    - "-I"
    - "src"
    - "-I"
    - "src/util"
    - "-I"
    - "src/third"
    - "-I"
    - "src/third/imgui"
    - "-I"
    - "src/third/imgui/backends"
  Remove:
    - "--target=wasm32-unknown-emscripten"
    - "-fvisibility=default"
    - "-DEMSCRIPTEN"
    - "-D__EMSCRIPTEN__"
    - "-D__wasm__"
    - "-D__wasm32__"

# C++ 模块支持
If:
  PathMatch: ["**/*.ixx", "**/*.cppm"]
  CompileFlags:
    Add: ["-fmodules-ts"]

Diagnostics:
  ClangTidy:
    Add: ["-*"]
    Remove:
      - "unused-parameter"
      - "missing-prototypes"
